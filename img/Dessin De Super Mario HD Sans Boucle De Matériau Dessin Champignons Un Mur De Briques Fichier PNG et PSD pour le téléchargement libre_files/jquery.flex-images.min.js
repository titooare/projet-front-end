!function(s){function m(t,e,a,r){function n(t){a.maxRows&&s>a.maxRows||a.truncate&&t&&1<s?f[o][0].style.display="none":(f[o][4]&&(f[o][3].attr("src",f[o][4]),f[o][4]=""),f[o][0].style.width=g+"px",f[o][0].style.height=c+"px",f[o][0].style.display="block")}var o,g,l=1,s=1,d=t.width()-2,f=[],w=0,c=a.rowHeight;for(d||(d=t.width()-2),i=0;i<e.length;i++)if(f.push(e[i]),d<=(w+=e[i][2]+a.margin)){var u=f.length*a.margin;for(l=(d-u)/(w-u),c=Math.ceil(a.rowHeight*l),exact_w=0,o=0;o<f.length;o++)g=Math.ceil(f[o][2]*l),exact_w+=g+a.margin,exact_w>d&&(g-=exact_w-d),n();f=[],w=0,s++}for(o=0;o<f.length;o++)g=Math.floor(f[o][2]*l),h=Math.floor(a.rowHeight*l),n(!0);r||d==t.width()||m(t,e,a,!0)}s.fn.flexImages=function(t){var l=s.extend({container:".item",object:"img",rowHeight:180,maxRows:0,truncate:0},t);return this.each(function(){var t=s(this),e=s(t).find(l.container),a=[],i=(new Date).getTime(),r=window.getComputedStyle?getComputedStyle(e[0],null):e[0].currentStyle;for(l.margin=(parseInt(r.marginLeft)||0)+(parseInt(r.marginRight)||0)+(Math.round(parseFloat(r.borderLeftWidth))||0)+(Math.round(parseFloat(r.borderRightWidth))||0),j=0;j<e.length;j++){var n=e[j],o=parseInt(n.getAttribute("data-w")),h=o*(l.rowHeight/parseInt(n.getAttribute("data-h"))),g=s(n).find(l.object);a.push([n,o,h,g,g.data("src")])}m(t,a,l),s(window).off("resize.flexImages"+t.data("flex-t")),s(window).on("resize.flexImages"+i,function(){m(t,a,l)}),t.data("flex-t",i)})}}(jQuery);